<!DOCTYPE html>
<html lang="it">
<head> 
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ParkFreender</title>
    <link rel="stylesheet" href="styles.css">
</head>

<script>
// All'inizio di ogni pagina HTML, controlla se l'utente è loggato
window.onload = function() {
    let info = JSON.parse(localStorage.getItem('authInfo'));
    if (info && info['access_token']) {
        // L'utente è loggato, quindi cambia il pulsante di login in logout
        document.querySelector('.buttonl').innerHTML = 'Log-out';
        document.querySelector('.buttonl').setAttribute('onclick', 'logout()');
    } else {
        // L'utente non è loggato, quindi mostra il pulsante di login
        document.querySelector('.buttonl').innerHTML = 'Sign In With Google';
        document.querySelector('.buttonl').setAttribute('onclick', 'signIn()');
    }
}

function logout(){
    let info = JSON.parse(localStorage.getItem('authInfo'));
    fetch("https://oauth2.googleapis.com/revoke?token=" + info['access_token'],{
        method:'POST',
        headers:{
            'Content-type':'application/x-www-form-urlencoded'
        }
    })
    .then((data) => {
        // Rimuovi le informazioni dell'utente dal localStorage
        localStorage.removeItem('authInfo');
        // Reindirizza l'utente alla pagina di login
        location.href = "http://localhost:8080/index_ParkFreender.html"
    })
}
</script>

<body>
    <header>
        <div class="logo">
            <img src="OIG2.png" alt="ParkFreender Logo">
        </div>
            <h1>ParkFreender</h1>
        <nav>
            <div class="nav-container">
                <a href="index_ParkFreender.html" class="current">Home</a>
                <a href="ParkFree.html">ParkFree</a>
                <a href="#parkpay">ParkPay</a>
                <a href="profile_ParkFreender.html">Il mio profilo</a>
                <a href="#contact">Contatti</a>
            </div>
        </nav>
        <div>
        <button class="buttonl" onclick="signIn()">
            <span class="button-content">Sign In With Google</span>
        </button>
        </div>
    </header>
    <main>
        <h2>Bentornato su ParkFreender!</h2>
        <p>Qui potrai trovare facilmente un parcheggio nella tua città.</p>
    </main>
</body>

<script src="scriptLoginGoogle.js"></script>

</html>
