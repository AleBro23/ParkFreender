<!DOCTYPE html>
<html>

<head>
    <title>Park Freender</title>
    <!--- custom css link-->
    <link rel="stylesheet" type="text/css" href="styles.css">
    <!--- boxicon link -->
    <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css" rel="stylesheet"/>
    <!--- google font link -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>

<script>
    // All'inizio di ogni pagina HTML, controlla se l'utente è loggato
    document.addEventListener("DOMContentLoaded", function() {
        let info = JSON.parse(localStorage.getItem('authInfo'));
        const loginButton = document.querySelector('.loginButton .loginButton-content');
        if (info && info['access_token']) {
            // L'utente è loggato, quindi cambia il pulsante di login in logout
            loginButton.innerHTML = 'Log-out';
            loginButton.parentNode.setAttribute('onclick', 'logout()');
        } else {
            // L'utente non è loggato, quindi mostra il pulsante di login
            loginButton.innerHTML = 'Sign-up with Google';
            loginButton.parentNode.setAttribute('onclick', 'signIn()');
        }
    });

    function logout() {
        let info = JSON.parse(localStorage.getItem('authInfo'));
        fetch("https://oauth2.googleapis.com/revoke?token=" + info['access_token'], {
            method: 'POST',
            headers: {
                'Content-type': 'application/x-www-form-urlencoded'
            }
        }).then(() => {
            localStorage.removeItem('authInfo');
            location.href = "http://localhost:3000/index_ParkFreender.html";
        });
    }
</script>

<body>

    <!---header design-->
    <header>
        <a href="#" class="logo">PARK<span>Freender</span></a>
        <ul class="navbar">
            <li><a href="index_ParkFreender.html">Home</a></li>
            <li><a href="parkFree_ParkFreender.html">ParkFree</a></li>
            <li><a href="#">ParkPay</a></li>
            <li><a href="#">Contact us</a></li>
        </ul>
        <div class="h-right">
            <button class="loginButton">
                <span class="loginButton-content">Sign-up with Google</span>
            </button>
            <a href="#"><i class="ri-github-fill"></i></a>
            <a href="#"><i class="ri-youtube-fill"></i></a>
            <a href="#"><i class="ri-instagram-fill"></i></a>
            <a href="#"><i class="ri-tiktok-fill"></i></a>
            <div class="bx bx-menu" id="menu-icon"></div>
        </div>
    </header>

    <!--- home section design -->
    <!--Popular parking design --> 
    <section class="mapFree">
        <div class="center-text2">
            <h1>Map Around You:</h1>
        </div>
        <div class="map-userFree">
            <!-- Immagine con i bordi smussati -->
            <img src="Image/ParkFree/mapExamples.png" alt="Map Around You" class="rounded-image">
        </div>
    </section>

    <!--Popular parking design --> 
    <section class="popular">
        <div class="center-text21">
            <h1>Free Parking:</h1>
        </div>
    
        <div class="card-content" id="parcheggi-container">
            <!-- le card dei parcheggi vengono create dinamicmente -->
        </div>
    </section>

    <!--- script js per prendere dati api e login -->
    <script src="script.js"></script>

</body>

</html>
